# Sequence Retrieval

## Running these scripts
You need to do two things to run these scripts:

- These rely on the Biopython module to run. PythonAnywhere.com has this module [installed by default](https://www.pythonanywhere.com/batteries_included/). To install on [Sourcelair.com](https://www.sourcelair.com/) and many other places, type `pip install biopython` at the terminal. Often ` easy_install biopython` will work at a terminal line as well. See [here](http://biopython.org/DIST/docs/install/Installation.html) for further information about installing the module if the previous suggestion didn't work for your situation. (In regards to PythonAnywhere... as of early February 2015, the version of the Biopython module listed for 2.7 was significantly behind and running `GetmRNAorCDSforProtein.py` actually elicited a warning of along the lines of `ESummary needing DTDs` unless the module updated. To update the module in your own PythonAnywhere account enter on the command line, `pip install --user --upgrade biopython`.) 

- Put your e-mail address in the User_Email variable under USER ADJUSTABLE VALUES. This is because NCBI wants a way to contact you if you are violating their policies.  See [Frequency, Timing and Registration of E-utility URL Requests](http://www.ncbi.nlm.nih.gov/books/NBK25497/).

---

**Description of each script**

- `GetmRNAforProtein.py`      

> protein --> mRNA  
`GetmRNAforProtein.py` takes a list of protein sequence records in FASTA format and gets the mRNA sequence corresponding to each.

**example of input and output for `GetmRNAforProtein.py`:**

original input:
```
>gi|354497310|ref|XP_003510764.1| PREDICTED: glycoprotein hormone alpha-2-like [Cricetulus griseus]
MPMAPRVLLLCLLVLAVIESHCWEAAIPGCHLHSFNVTVRSGRHGTCQGSHVAQACVGHCESSAFPSRHS
VLVASGYRHNITSVSQCCTISSLKKVKVWLSCMGNQRGELEIFTARACQCDMCRLSRY

>gi|379645662|gb|AFD04550.1| gonadotropin common alpha subunit [Cynoglossus semilaevis]
MEGKATAASTMGSVKSATLSLLLLTFSLYVADSYHSKDLQKLGCESCTLGKNDLFSLYGPVYQCQGCCFS
RAFPTPLTTLETMESRKNITSEATCCVARSSYEVVVAGIVVRNHTDCHCSTCKYHKI
```

Command:

    python GetmRNAforProtein.py sequence_list.fa  


Output:
```
>gi|625218702|ref|XM_003510716.2| PREDICTED: Cricetulus griseus glycoprotein hormone alpha 2 (Gpha2), mRNA
CCTAACCCTAGTCTGCCACCAAGCACAGCTTAGTGCCCCCAATGGTGGGACACCCCTTAAACAAAATAAT
CTTGTTCTTGGACTGGGGATGTACCTCCATTGGTTGAGTGCCTCCCTAGCATGCACAGGCCCTGGATTTG
ACCCCAGAACAACATAAACTGGATGTGGGGCTCATGCCTTTTATTCTAGGACTTGGAAGGTAGAGGCAGA
AGGATCAGAAGTTCAAGGTTTCTTTTACTATTACTTTTCTTTTACTATTACTTTTTAGGACAATGTGAAT
CTCTTCTTTTCCCTATTACTTTGCAATCACTAAAAGGCAGATAGGCAACAGGACTGAGAGTAGTCATTTT
TAGACAGAGAATAACTGTTCAAAGAAGAGTCCTGCCCAAGCTCACAGAGTGGGAAGAGGACCCCGCTGCA
CACGTCACACTCCTGAGCTTGCTTCACTCTCTCTAGTACTCTTCCCTTCTGGGGAAGGGAAATGTCAGCA
GATCACTCTCTGAAGAAACCTCAGATTGTGATCCCCAGGTGGGACTGTGCTGAGGCTTCAGGCTAGGAGG
AGCCTGAAAGATGATATCTAGGAAGGCGTGGCTCTAAAACCCAGGCAAATAAAAGCCTGCGGAGCCAGCA
CCAGTTTGGAGACCAGCAGGAGGCACTGGGAGTCTACAGCCGTCTGTTTCTGCTGGACTGGTGAGCTGCT
GAAGCAGGAGACCAGGTGGAGCTGGGAAGGGCAGGAGGGTTGTGGTTAGGGCCTTTTGGCCAAAGCAGCA
TGTGGAGGGGGGAAGAACTTTGTACCCCAGATGGTGTGGGACATTCCAGGGAAAATCTGCACAGAAGGAT
GACAAGTCCCATCCAGAAATGGCTACCCTTTCAGAGTAGCCCAGGCAGAGTGGCACATCCCTACCAAAGA
CAGGATAGACAGCACCACCCAGGCACACCTCACTAGACAGCAGACCCAGCAGCCTGGCCTGCCAGTAGAG
AGTCATGTATTCAAAGACCTCCCCTTCCACCCATTCCTTTTCAGATGCCCATGGCACCACGTGTCCTGCT
CCTCTGCCTGCTGGTTCTGGCAGTCATTGAAAGCCATTGTTGGGAGGCAGCCATCCCGGGCTGCCACTTG
CACTCCTTCAATGTGACAGTGCGAAGTGGCCGCCATGGCACCTGCCAGGGCTCCCATGTAGCGCAGGCCT
GTGTAGGACATTGTGAGTCTAGTGCCTTCCCTTCCCGGCACTCTGTGTTGGTGGCCAGTGGCTATCGGCA
CAACATCACCTCTGTCTCTCAGTGCTGTACCATTAGCAGTCTAAAAAAGGTAAAGGTGTGGCTGAGCTGC
ATGGGGAACCAGCGGGGGGAACTTGAGATCTTTACCGCCAGAGCCTGCCAGTGTGATATGTGCCGTCTCT
CCCGCTACTAGTCCCTGCCTGAAGGGCTCAGGCCCAGGTCCTGCCACTGATATGCTATAGGATCTCTCAA
ATGAGGGGGCTACTTCAGTTCTGACCCTCTTTAGAGTTAGTGAAGATGCCTAGCATT

>gi|379645661|gb|JQ364953.1| Cynoglossus semilaevis gonadotropin common alpha subunit mRNA, complete cds
ACATGGGGAGTGCCAGGAGTTCTCTACAGACGCACCATGGAAGGGAAGGCAACCGCTGCGTCCACAATGG
GCTCGGTGAAATCAGCAACTCTGTCTCTTCTTCTGTTGACCTTTTCTCTTTATGTAGCTGACTCTTACCA
CAGCAAAGACCTACAGAAATTGGGCTGCGAGAGTTGCACTCTGGGAAAGAATGATTTATTCTCACTATAT
GGTCCAGTCTACCAGTGCCAGGGCTGCTGCTTCTCACGAGCGTTCCCCACTCCTCTAACGACATTGGAAA
CGATGGAAAGTCGAAAGAACATCACTTCAGAGGCGACGTGCTGCGTGGCCAGGTCCAGCTATGAGGTAGT
GGTGGCTGGTATTGTGGTGAGAAACCACACAGACTGCCACTGTAGTACCTGTAAATACCACAAGATATGA
CAGAACAGGGGACCACGCTGCAGAGCTCAGCTTCACGGCACATCATTATTCATTTAGTGAACTGTGCCAA
AGATAGTTTTTCTTTTTCAAAAATGTGTTTTAAAACCGATCACACTTTTGCAGTGATCCTTAGTCTGTGA
CGTGTAATTAGTCCACACACTGTCCTTTGTAGATGTACTCTGTGTAATCGATGATGTAATGGAAAGCAAT
TAAATGAAAACATGCATCTTTATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
```

---

- `GetmRNAorCDSforProtein.py`

> protein --> mRNA or CDS  
`GetmRNAorCDSforProtein.py` takes a list of protein sequence records in FASTA format and gets the mRNA or CDS sequence corresponding to each.

**example of input and output for `GetmRNAorCDSforProtein.py`:**

original input:
```
>gi|354497310|ref|XP_003510764.1| PREDICTED: glycoprotein hormone alpha-2-like [Cricetulus griseus]
MPMAPRVLLLCLLVLAVIESHCWEAAIPGCHLHSFNVTVRSGRHGTCQGSHVAQACVGHCESSAFPSRHS
VLVASGYRHNITSVSQCCTISSLKKVKVWLSCMGNQRGELEIFTARACQCDMCRLSRY

>gi|357618926|gb|EHJ71710.1| glycoprotein hormone alpha 2 [Danaus plexippus]
MFLRNFILLLTLSHLLVAQSYKKPGCHRQGHTRSISIPDCVEFKITTNACRGYCESYSLPSIMLGFKRHP
VTSLGQCCNIMESEDIPVKVLCLDGERNLVFKSAVTCACYHCQKE

>gi|379645662|gb|AFD04550.1| gonadotropin common alpha subunit [Cynoglossus semilaevis]
MEGKATAASTMGSVKSATLSLLLLTFSLYVADSYHSKDLQKLGCESCTLGKNDLFSLYGPVYQCQGCCFS
RAFPTPLTTLETMESRKNITSEATCCVARSSYEVVVAGIVVRNHTDCHCSTCKYHKI
```

Command:

    python GetmRNAorCDSforProtein.py sequence_list.fa  
 
Output:
```
>gi|625218702|ref|XM_003510716.2| PREDICTED: Cricetulus griseus glycoprotein hormone alpha 2 (Gpha2), mRNA
CCTAACCCTAGTCTGCCACCAAGCACAGCTTAGTGCCCCCAATGGTGGGACACCCCTTAAACAAAATAAT
CTTGTTCTTGGACTGGGGATGTACCTCCATTGGTTGAGTGCCTCCCTAGCATGCACAGGCCCTGGATTTG
ACCCCAGAACAACATAAACTGGATGTGGGGCTCATGCCTTTTATTCTAGGACTTGGAAGGTAGAGGCAGA
AGGATCAGAAGTTCAAGGTTTCTTTTACTATTACTTTTCTTTTACTATTACTTTTTAGGACAATGTGAAT
CTCTTCTTTTCCCTATTACTTTGCAATCACTAAAAGGCAGATAGGCAACAGGACTGAGAGTAGTCATTTT
TAGACAGAGAATAACTGTTCAAAGAAGAGTCCTGCCCAAGCTCACAGAGTGGGAAGAGGACCCCGCTGCA
CACGTCACACTCCTGAGCTTGCTTCACTCTCTCTAGTACTCTTCCCTTCTGGGGAAGGGAAATGTCAGCA
GATCACTCTCTGAAGAAACCTCAGATTGTGATCCCCAGGTGGGACTGTGCTGAGGCTTCAGGCTAGGAGG
AGCCTGAAAGATGATATCTAGGAAGGCGTGGCTCTAAAACCCAGGCAAATAAAAGCCTGCGGAGCCAGCA
CCAGTTTGGAGACCAGCAGGAGGCACTGGGAGTCTACAGCCGTCTGTTTCTGCTGGACTGGTGAGCTGCT
GAAGCAGGAGACCAGGTGGAGCTGGGAAGGGCAGGAGGGTTGTGGTTAGGGCCTTTTGGCCAAAGCAGCA
TGTGGAGGGGGGAAGAACTTTGTACCCCAGATGGTGTGGGACATTCCAGGGAAAATCTGCACAGAAGGAT
GACAAGTCCCATCCAGAAATGGCTACCCTTTCAGAGTAGCCCAGGCAGAGTGGCACATCCCTACCAAAGA
CAGGATAGACAGCACCACCCAGGCACACCTCACTAGACAGCAGACCCAGCAGCCTGGCCTGCCAGTAGAG
AGTCATGTATTCAAAGACCTCCCCTTCCACCCATTCCTTTTCAGATGCCCATGGCACCACGTGTCCTGCT
CCTCTGCCTGCTGGTTCTGGCAGTCATTGAAAGCCATTGTTGGGAGGCAGCCATCCCGGGCTGCCACTTG
CACTCCTTCAATGTGACAGTGCGAAGTGGCCGCCATGGCACCTGCCAGGGCTCCCATGTAGCGCAGGCCT
GTGTAGGACATTGTGAGTCTAGTGCCTTCCCTTCCCGGCACTCTGTGTTGGTGGCCAGTGGCTATCGGCA
CAACATCACCTCTGTCTCTCAGTGCTGTACCATTAGCAGTCTAAAAAAGGTAAAGGTGTGGCTGAGCTGC
ATGGGGAACCAGCGGGGGGAACTTGAGATCTTTACCGCCAGAGCCTGCCAGTGTGATATGTGCCGTCTCT
CCCGCTACTAGTCCCTGCCTGAAGGGCTCAGGCCCAGGTCCTGCCACTGATATGCTATAGGATCTCTCAA
ATGAGGGGGCTACTTCAGTTCTGACCCTCTTTAGAGTTAGTGAAGATGCCTAGCATT

>gi|AGBW01005318.1:3193-3286(+) glycoprotein hormone alpha 2 [Danaus plexippus] mRNA cds , corresponds to cds for protein sequence GI_number 357618926
ATGTTCCTTAGAAATTTTATTTTACTTTTAACCCTTAGTCATTTACTCGTTGCACAAAGT
TACAAAAAACCTGGTTGCCACAGACAAGGTCATACAAGAAGTATTAGTATCCCGGATTGT
GTTGAATTCAAAATAACAACAAACGCCTGCCGTGGTTATTGCGAATCATATTCACTACCC
AGCATTATGCTTGGCTTCAAAAGACATCCCGTTACTTCGCTGGGACAATGCTGCAATATT
ATGGAATCGGAAGACATCCCAGTGAAAGTGCTATGCTTGGACGGAGAGAGAAATTTAGTA
TTTAAATCCGCTGTTACCTGTGCCTGCTACCATTGTCAAAAAGAATAA

>gi|379645661|gb|JQ364953.1| Cynoglossus semilaevis gonadotropin common alpha subunit mRNA, complete cds
ACATGGGGAGTGCCAGGAGTTCTCTACAGACGCACCATGGAAGGGAAGGCAACCGCTGCGTCCACAATGG
GCTCGGTGAAATCAGCAACTCTGTCTCTTCTTCTGTTGACCTTTTCTCTTTATGTAGCTGACTCTTACCA
CAGCAAAGACCTACAGAAATTGGGCTGCGAGAGTTGCACTCTGGGAAAGAATGATTTATTCTCACTATAT
GGTCCAGTCTACCAGTGCCAGGGCTGCTGCTTCTCACGAGCGTTCCCCACTCCTCTAACGACATTGGAAA
CGATGGAAAGTCGAAAGAACATCACTTCAGAGGCGACGTGCTGCGTGGCCAGGTCCAGCTATGAGGTAGT
GGTGGCTGGTATTGTGGTGAGAAACCACACAGACTGCCACTGTAGTACCTGTAAATACCACAAGATATGA
CAGAACAGGGGACCACGCTGCAGAGCTCAGCTTCACGGCACATCATTATTCATTTAGTGAACTGTGCCAA
AGATAGTTTTTCTTTTTCAAAAATGTGTTTTAAAACCGATCACACTTTTGCAGTGATCCTTAGTCTGTGA
CGTGTAATTAGTCCACACACTGTCCTTTGTAGATGTACTCTGTGTAATCGATGATGTAATGGAAAGCAAT
TAAATGAAAACATGCATCTTTATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
```

## Impending issues and to do
- These scripts may have issues working as written once the GI sequence identifiers get phased out as described in section 1.4.1 of the [June 15 2015 Distribution Release Notes for NCBI-GenBank Flat File Release 208.0](ftp://ftp.ncbi.nih.gov/genbank/gbrel.txt) that can be found at ftp://ftp.ncbi.nih.gov/genbank/gbrel.txt. The GI accession form will be phased out by mid 2016 according to those release notes.
- I should work on switching them over to the Accession.Version system. 


# Related scripts by others

I came across someone else's (Leighton Pritchard) take on getting coding sequences for proteins with the protein sequence in early 2018:
Maybe useful stuff or better? See [here](https://twitter.com/widdowquinn/status/963148471334158336)

>"Need to work backwards from proteins to their coding sequences? Tired of trawling through the database to get the CDS? Me, too. So I wrote this: https://widdowquinn.github.io/ncfp/     I hope you find it useful. Bugs, issues etc. here, please: https://github.com/widdowquinn/ncfp/issues â€¦"

